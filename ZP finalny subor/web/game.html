<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/game.css">
    <link rel="icon" type="image/png" href="/LCfavicon.png">
    <title>Klikacia Hra</title>
    <style>
        .hidden {
            display: none;
        }
    </style>
</head>

<body>
    <div id="game-container">
        <div id="timer-level-score-container">
            <div id="timer-container"></div>
            <div id="level-score-container">
                <div id="level-container" class="hidden">Level 1</div>
                <div id="score-container" class="hidden">Skóre: 0</div>
            </div>
            <div id="instructions-container">
                <h1 style="color:red">Inštrukcie pre level 1 </h1>
                <p> Klikajte na štvorce v poradí od 1 do 15. Na tento level máte 45 sekúnd.</p>
                <p> V prípade vypršania času budete automaticky presmerovaný na level 2.</p>
                <p> Cieľom je ich vyklikať čo najrýchlejšie s čo najmenšou chybovosťou.</p>
            </div>
        </div>
        <button id="start-button">Štart</button>
        <canvas id="game-canvas" width="1000" height="600"></canvas>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="/game.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const startButton = document.getElementById('start-button');
                const instructionsContainer = document.getElementById('instructions-container');
                const levelContainer = document.getElementById('level-container');
                const scoreContainer = document.getElementById('score-container');

                startButton.addEventListener('click', function () {
                    startButton.classList.add('hidden');
                    instructionsContainer.classList.add('hidden');
                    levelContainer.classList.remove('hidden'); // Zobraziť level container po stlačení tlačidla Štart
                    scoreContainer.classList.remove('hidden'); // Zobraziť score container po stlačení tlačidla Štart
                     instructionsContainer.style.display = 'none'; // Skryť inštrukcie po stlačení tlačidla Štart
                });

                // Funkcia na zobrazenie inštrukcií pre daný level
                function showInstructions(level) {
                    if (level === 1) {
                        instructionsContainer.style.display = 'block'; // inštrukcie iba pre prvý level
                    } else {
                        instructionsContainer.style.display = 'none';
                    }
                }

                showInstructions(1);

                // získanie session ID z cookies
                const getSessionIDFromCookie = () => {
                    return document.cookie.replace(/(?:(?:^|.*;\s*)session\s*\=\s*([^;]*).*$)|^.*$/, "$1");
                };

                // získanie času expirácie session cookie 
                const getSessionCookieExpiration = () => {
                    const cookies = document.cookie.split(';');
                    for (let i = 0; i < cookies.length; i++) {
                        const cookie = cookies[i].trim();
                        if (cookie.startsWith('session=')) {
                            const cookieParts = cookie.split('=');
                            const expirationString = decodeURIComponent(cookieParts[1]); // dekódovanie...
                            const expiration = new Date(expirationString);
                            if (!isNaN(expiration.getTime())) { // kontrola expirácie sessionu
                                const now = new Date();
                                const diffMs = expiration - now;
                                const diffMins = Math.round(diffMs / 60000); // Konvertovať milisekundy na minúty
                                return diffMins;
                            } else {
                                return null;
                            }
                        }
                    }
                    return null;
                };

                // Zobrazím si session ID ako pomocku 
                const sessionID = getSessionIDFromCookie();
                const expiration = getSessionCookieExpiration();
                console.log(`Session ID: ${sessionID} (Vyprší: ${expiration})`);
            });
        </script>
    </div>
</body>

</html>
